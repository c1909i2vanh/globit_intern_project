{"ast":null,"code":"import axios from \"axios\";\nimport localStorageService from \"./localStorageService\";\nimport ConstantList from \"../appConfig\";\nimport UserService from \"../services/UserService\";\nconst config = {\n  headers: {\n    'Content-Type': 'application/x-www-form-urlencoded',\n    'Authorization': 'Basic Y29yZV9jbGllbnQ6c2VjcmV0'\n  }\n};\n\nclass JwtAuthService {\n  constructor() {\n    this.user = {\n      userId: \"1\",\n      role: 'ADMIN',\n      displayName: \"Watson Joyce\",\n      email: \"watsonjoyce@gmail.com\",\n      photoURL: ConstantList.ROOT_PATH + \"assets/images/face-7.jpg\",\n      age: 25,\n      token: \"faslkhfh423oiu4h4kj432rkj23h432u49ufjaklj423h4jkhkjh\"\n    };\n\n    this.loginWithUserNameAndPassword = (username, password) => {\n      let requestBody = 'client_id=core_client&grant_type=password&client_secret=secret';\n      requestBody = requestBody + '&username=' + username + '&password=' + password;\n      return axios.post(ConstantList.API_ENPOINT + '/oauth/token', requestBody, config).then(response => {\n        //this.setUser(data);\n        console.log(response);\n        alert(response.data.access_token);\n        this.setSession(response.data.access_token);\n        this.setLoginUser(response.data);\n      });\n    };\n\n    this.loginWithEmailAndPassword = (email, password) => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          resolve(this.user);\n        }, 1000);\n      }).then(data => {\n        //console.log(data);\n        this.setUser(data);\n        this.setSession(data.token);\n        alert(data.token);\n        return data;\n      });\n    };\n\n    this.loginWithToken = () => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          resolve(this.user);\n        }, 100);\n      }).then(data => {\n        this.setSession(data.token);\n        this.setUser(data);\n        return data;\n      });\n    };\n\n    this.logout = () => {\n      if (ConstantList.AUTH_MODE == \"Keycloak\") {\n        UserService.doLogout();\n      }\n\n      this.setSession(null);\n      this.removeUser();\n    };\n\n    this.setSession = token => {\n      //alert('setSession');\n      if (token) {\n        localStorage.setItem(\"jwt_token\", token);\n        axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\n      } else {\n        localStorage.removeItem(\"jwt_token\");\n        delete axios.defaults.headers.common[\"Authorization\"];\n      }\n    };\n\n    this.setLoginUser = data => {\n      let user = {};\n      user.token = data.access_token;\n      user.role = \"ADMIN\";\n      user.age = 25;\n      user.displayName = \"Watson Joyce\";\n      user.photoURL = ConstantList.ROOT_PATH + \"assets/images/face-7.jpg\";\n      this.user = user;\n      localStorageService.setItem(\"auth_user\", user);\n      return user;\n    };\n\n    this.setLoginToken = data => {\n      let user = {};\n      user.token = data;\n      user.role = \"ADMIN\";\n      user.age = 25;\n      user.displayName = \"Watson Joyce\";\n      user.photoURL = ConstantList.ROOT_PATH + \"assets/images/face-7.jpg\";\n      this.user = user;\n      localStorageService.setItem(\"auth_user\", user);\n      return user;\n    };\n\n    this.setUser = user => {\n      localStorageService.setItem(\"auth_user\", user);\n    };\n\n    this.removeUser = () => {\n      localStorage.removeItem(\"auth_user\");\n    };\n  }\n\n}\n\nexport default new JwtAuthService();","map":{"version":3,"sources":["C:/Users/GIANG/Documents/SpringProject/sample-project-v2/client/react/src/app/services/jwtAuthService.js"],"names":["axios","localStorageService","ConstantList","UserService","config","headers","JwtAuthService","user","userId","role","displayName","email","photoURL","ROOT_PATH","age","token","loginWithUserNameAndPassword","username","password","requestBody","post","API_ENPOINT","then","response","console","log","alert","data","access_token","setSession","setLoginUser","loginWithEmailAndPassword","Promise","resolve","reject","setTimeout","setUser","loginWithToken","logout","AUTH_MODE","doLogout","removeUser","localStorage","setItem","defaults","common","removeItem","setLoginToken"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport localStorageService from \"./localStorageService\";\nimport ConstantList from \"../appConfig\";\nimport UserService from \"../services/UserService\";\nconst config = {\n  headers: {\n    'Content-Type': 'application/x-www-form-urlencoded',\n    'Authorization':'Basic Y29yZV9jbGllbnQ6c2VjcmV0'\n  }\n}\nclass JwtAuthService {\n\n\n  user = {\n    userId: \"1\",\n    role: 'ADMIN',\n    displayName: \"Watson Joyce\",\n    email: \"watsonjoyce@gmail.com\",\n    photoURL:  ConstantList.ROOT_PATH+\"assets/images/face-7.jpg\",\n    age: 25,\n    token: \"faslkhfh423oiu4h4kj432rkj23h432u49ufjaklj423h4jkhkjh\"\n  }\n  loginWithUserNameAndPassword = (username, password) => {\n    let requestBody ='client_id=core_client&grant_type=password&client_secret=secret';\n    requestBody =requestBody+'&username='+username +'&password='+password;\n    return axios.post(ConstantList.API_ENPOINT+'/oauth/token',requestBody,config).then(response=>{\n      //this.setUser(data);\n      console.log(response);\n      alert(response.data.access_token);\n      this.setSession(response.data.access_token);\n      this.setLoginUser(response.data);\n    });\n  };\n\n  loginWithEmailAndPassword = (email, password) => {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        resolve(this.user);\n      }, 1000);\n    }).then(data => {\n      //console.log(data);\n      this.setUser(data);\n      this.setSession(data.token);      \n      alert(data.token);\n      return data;\n    });\n  };\n\n  loginWithToken = () => {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        resolve(this.user);\n      }, 100);\n    }).then(data => {\n      this.setSession(data.token);\n      this.setUser(data);\n      return data;\n    });\n  };\n\n  \n\n  logout = () => {\n    if(ConstantList.AUTH_MODE==\"Keycloak\"){\n      UserService.doLogout();\n    }    \n    this.setSession(null);\n    this.removeUser();\n  }\n\n  setSession = token => {\n    //alert('setSession');\n    if (token) {\n      localStorage.setItem(\"jwt_token\", token);\n      axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\n    } else {\n      localStorage.removeItem(\"jwt_token\");\n      delete axios.defaults.headers.common[\"Authorization\"];\n    }\n  };\n  setLoginUser = (data) => {   \n    let user ={};\n    user.token = data.access_token; \n    user.role=\"ADMIN\";\n    user.age=25;\n    user.displayName =\"Watson Joyce\";\n    user.photoURL =ConstantList.ROOT_PATH+\"assets/images/face-7.jpg\";\n    this.user = user;\n    localStorageService.setItem(\"auth_user\", user);\n    return user;\n  }\n\n  setLoginToken = (data) => {   \n    let user ={};\n    user.token = data; \n    user.role=\"ADMIN\";\n    user.age=25;\n    user.displayName =\"Watson Joyce\";\n    user.photoURL =ConstantList.ROOT_PATH+\"assets/images/face-7.jpg\";\n    this.user = user;\n    localStorageService.setItem(\"auth_user\", user);\n    return user;\n  }\n\n  setUser = (user) => {    \n    localStorageService.setItem(\"auth_user\", user);\n  }\n  removeUser = () => {\n    localStorage.removeItem(\"auth_user\");\n  }\n}\n\nexport default new JwtAuthService();\n"]},"metadata":{},"sourceType":"module"}